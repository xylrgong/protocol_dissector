H1_TIMEOUT = 5  # 单位： 秒

H1_ERR_CODE = {
    100: 'Invalid dst mac',
    101: 'Invalid src mac',
    102: 'Invalid dst ref',
    103: 'Invalid src ref',
    200: 'Timeout',
    201: 'Connection closed'
}

EQUIP_NAME = (
    {
        b'\x0e\x00\x1f': "aa101",  #
        b'\x10\x00\x3a': "aa102",  #
        b'\x11\x00\x34': "aa103",  #
        b'\x13\x00\x13': "aa104",  #
    }
)
AA101 = (
    {
        '7070040e80000000001f8100200f783f6ff48100783f69f48000783f6bf48000783f63f48000783f64f48000783f6af48000783f68f48100783f6ef46500': "关闭",
        '7070040e80000000001f8100200f783f6ff48000783f69f48000783f6bf48000783f63f48000783f64f48000783f6af48100783f68f48100783f6ef46500': "开启",
        '7070040e80000000001f8100200f783f6ff48000783f69f48000783f6bf48000783f63f48000783f64f48000783f6af48000783f68f48100783f6ef46500': "重置状态"
    }
)

AA102 = (
    {
        '7070041080000000003a81002064783f6f028100783f69028000783f68028100783f6e02783f3e04783f65003d4f2d0800e600136400000500020836640c783f3f04783f63003d4f2d0800e6001164000003000208346408783f3d04783f64003d4f2d0800e600126400000400020835640a6500': "关闭",
        '7070041080000000003a81002064783f6f028000783f69028100783f68028100783f6e02783f3e04783f65003d4f2d0800e600136400000500020836640c783f3f04783f63003d4f2d0800e6001164000003000208346408783f3d04783f64003d4f2d0800e600126400000400020835640a6500': "开启",
        '7070041080000000003a81002064783f6f028000783f69028000783f68028100783f6e02783f3e04783f65003d4f2d0800e600136400000500020836640c783f3f04783f63003d4f2d0800e6001164000003000208346408783f3d04783f64003d4f2d0800e600126400000400020835640a6500': "重置状态"
    }
)

AA103 = (
    {
        '70700411800000000034a000fc02b10a8000910a810a300205001c02f802200f783f68f6a100fc01b00a8100900a800a300211001c01f801783f69f68100783f6ef68100783f6ff6200a783f2f0c2064783f66003d4f2d0800e600146400000600020857640e6500': "关闭",
        '70700411800000000034a100fc02b10a8100910a810a300205001c02f802200f783f68f6a000fc01b00a8000900a800a300211001c01f801783f69f68100783f6ef68100783f6ff6200a783f2f0c2064783f66003d4f2d0800e600146400000600020857640e6500': "开启",
        '70700411800000000034a000fc02b10a8000910a810a300205001c02f802200f783f68f6a000fc01b00a8000900a800a300211001c01f801783f69f68100783f6ef68100783f6ff6200a783f2f0c2064783f66003d4f2d0800e600146400000600020857640e6500': "重置状态"
    }
)

AA104 = (
    {
        '7070041380000000001381002064783f69108000783f68108100783f6e108100783f6f106500': "关闭",
        '7070041380000000001380002064783f69108100783f68108100783f6e108100783f6f106500': "开启",
        '7070041380000000001380002064783f69108000783f68108100783f6e108100783f6f106500': "重置状态"
    }
)

OPERATE_DATA = (
    {
        "aa101": AA101,  #
        "aa102": AA102,  #
        "aa103": AA103,  #
        "aa104": AA104,  #
    }
)

class S5_COTP_Params(object):
    def __init__(self, dmac='00:00:00:00:00:00', smac='00:00:00:00:00:00', sref=0x00, iface=''):
        self.iface = iface
        self.dmac = dmac
        self.smac = smac
        self.sref = sref

h1_payload = {
    '5124': [('client', ['DB', 0x02, 0x1404, 0x0402, 0x0402]), '00000000103f1032000efc02'],
    '5124_ap': [('client', ['DB', 0x02, 0x1404, 0x0402, 0x0402]), '00000000103f1032000efc00'],
    '21252': [('client', ['DB', 0x02, 0x5304, 0x0402, 0x0402]), '010204010401000202'],
    '21252_': [('client', ['DB', 0x02, 0x5304, 0x0404, 0x0402]), '010204010401000202'],
    '6148': [('client', ['DB', 0x02, 0x1804, 0x0402, 0x0402]), ''],
    '7428': [('client', ['DB', 0x02, 0x1d04, 0x0402, 0x0402]), ''],
    '7684': [('client', ['DB', 0x02, 0x1e04, 0x0402, 0x0402]), '0a'],
    '6916': [('client', ['DB', 0x02, 0x1b04, 0x0402, 0x0402]), '01'],
    '32771': [('client', ['EB', 0x02, 0x8003, 0x0404, 0x0402]), ''],
    '33027': [('client', ['EB', 0x02, 0x8103, 0x0404, 0x0402]), ''],
    '772': [('client', ['DB', 0x02, 0x0304, 0x0402, 0x0402]), '000efc02000efc020002'],
    '1028': [('client', ['DB', 0x02, 0x0404, 0x0402, 0x0402]), '000ef0f0000ef0f4'],
    '1028_': [('client', ['DB', 0x02, 0x0404, 0x0402, 0x0402]), '000ef007000ef00b'],
    'aa101': [('client', ['DB', 0x02, 0x0804, 0x0402, 0x0402]), '040e001f'],
    'aa101open': [('client', ['MB', 0x02, 0x0004, 0x0402, 0x0402]), '7070040e80000000001f8100200f783f6ff48000783f69f48000783f6bf48000783f63f48000783f64f48000783f6af48100783f68f48100783f6ef46500'],
    'aa101close': [('client', ['MB', 0x02, 0x0004, 0x0402, 0x0402]), '7070040e80000000001f8100200f783f6ff48100783f69f48000783f6bf48000783f63f48000783f64f48000783f6af48000783f68f48100783f6ef46500'],
    'aa101reset': [('client', ['MB', 0x02, 0x0004, 0x0402, 0x0402]), '7070040e80000000001f8100200f783f6ff48000783f69f48000783f6bf48000783f63f48000783f64f48000783f6af48000783f68f48100783f6ef46500'],
    'aa102': [('client', ['DB', 0x02, 0x0804, 0x0402, 0x0402]), '0410003a'],
    'aa102open': [('client', ['MB', 0x02, 0x0004, 0x0402, 0x0402]), '7070041080000000003a81002064783f6f028000783f69028100783f68028100783f6e02783f3e04783f65003d4f2d0800e600136400000500020836640c783f3f04783f63003d4f2d0800e6001164000003000208346408783f3d04783f64003d4f2d0800e600126400000400020835640a6500'],
    'aa102close': [('client', ['MB', 0x02, 0x0004, 0x0402, 0x0402]), '7070041080000000003a81002064783f6f028100783f69028000783f68028100783f6e02783f3e04783f65003d4f2d0800e600136400000500020836640c783f3f04783f63003d4f2d0800e6001164000003000208346408783f3d04783f64003d4f2d0800e600126400000400020835640a6500'],
    'aa102reset': [('client', ['MB', 0x02, 0x0004, 0x0402, 0x0402]), '7070041080000000003a81002064783f6f028000783f69028000783f68028100783f6e02783f3e04783f65003d4f2d0800e600136400000500020836640c783f3f04783f63003d4f2d0800e6001164000003000208346408783f3d04783f64003d4f2d0800e600126400000400020835640a6500'],
    'aa103': [('client', ['DB', 0x02, 0x0804, 0x0402, 0x0402]), '04110034'],
    'aa103open': [('client', ['MB', 0x02, 0x0004, 0x0402, 0x0402]), '70700411800000000034a100fc02b10a8100910a810a300205001c02f802200f783f68f6a000fc01b00a8000900a800a300211001c01f801783f69f68100783f6ef68100783f6ff6200a783f2f0c2064783f66003d4f2d0800e600146400000600020857640e6500'],
    'aa103close': [('client', ['MB', 0x02, 0x0004, 0x0402, 0x0402]), '70700411800000000034a000fc02b10a8000910a810a300205001c02f802200f783f68f6a100fc01b00a8100900a800a300211001c01f801783f69f68100783f6ef68100783f6ff6200a783f2f0c2064783f66003d4f2d0800e600146400000600020857640e6500'],
    'aa103reset': [('client', ['MB', 0x02, 0x0004, 0x0402, 0x0402]), '70700411800000000034a000fc02b10a8000910a810a300205001c02f802200f783f68f6a000fc01b00a8000900a800a300211001c01f801783f69f68100783f6ef68100783f6ff6200a783f2f0c2064783f66003d4f2d0800e600146400000600020857640e6500'],
    'aa104': [('client', ['DB', 0x02, 0x0804, 0x0402, 0x0402]), '04130013'],
    'aa104open': [('client', ['MB', 0x02, 0x0004, 0x0402, 0x0402]), '7070041380000000001380002064783f69108100783f68108100783f6e108100783f6f106500'],
    'aa104close': [('client', ['MB', 0x02, 0x0004, 0x0402, 0x0402]), '7070041380000000001381002064783f69108000783f68108100783f6e108100783f6f106500'],
    'aa104reset': [('client', ['MB', 0x02, 0x0004, 0x0402, 0x0402]), '7070041380000000001380002064783f69108000783f68108100783f6e108100783f6f106500'],
}

h1_server_payload={
    '65283': [('server', ['MB', 0x02, 0xff03, 0x0402, 0x2020]), '0102000300'],
    '3': [('server', ['MB', 0x02, 0x0003, 0x0404, 0x2020]), 'ff00ff00efe0efe8efc0efa0ef80ef409432cfffef0001000100010001000100010001000700013800050222'],
    '3_': [('server', ['MB', 0x02, 0x0003, 0x0404, 0x2020]), '00000000007600000000c000000000000001000000000000000000008000000000000000000000000d7d000000000000000000000e4e000000002000000000008000000000000000000000008000000000000000'],
    '3_ap': [('server', ['MB', 0x02, 0x0003, 0x0404, 0x2020]), '000000000000000004130037b04320230008'],
    '4611': [('server', ['EB', 0x02, 0x1203, 0x0404, 0x2020]), ''],
    'unknown': [('Unknown',[]), '020a0402fe03060d0200ff00ff00efe0efe8efc0efa0ef80ef409432'],
    '4099': [('server', ['EB', 0x02, 0x1003, 0x0404, 0x2020]), ''],
    '0': [('server', ['MB', 0x02, 0x0000, 0x0404, 0x2020]), '0000000000002f7d2ffd00003d343d453d563d67569956aa56bb56cc56dd56ee56ff57105721573257435754576557765787579857a957ba57cb57dc57ed57fe580f5820583158425853586458755886589758a858b958ca58db58ec58fd590e591f593059415952596359745985599659a759b859c959da59eb59fc5a0d5a1e5a2f5a405a515a625a735a845a955aa65ab75ac85ad95aea289c27c15cb35cb45cb55cb65cb75cb85cb95cba5cbb5cbc5cbd5cbe5cbf5cc05cc15cc25cc35cc45cc55cc65cc75cc82c435cc95cca5ccb5ccc5ccd5cce5ccf5cd05cd15cd25cd35cd45cd55cd65cd75cd85cd95cda5cdb5cdc5cdd5cde5cdf5ce05ce15ce25ce3'],
    '3_valve': [('server', ['MB', 0x02, 0x0003, 0x0404, 0x2020]), '5ce45ce52aa42a1d2996290f2ef45ce65ce75ce85ce95cea5ceb5cec5ced5cee5cef5cf05cf15cf25cf35cf45cf55cf65cf75cf85cf95cfa5cfb5cfc5cfd5cfe5cff5d005d015d025d035d045d055d065d075d085d095d0a5d0b5d0c5d0d5d0e5d0f5d105d115d122d362cd05d135d145d152d472cbf2cae2cf22ce12d032c9d2d142d252c855d165d175d185d195d1a5d1b5d1c5d1d5d1e5d1f5d205d215d225d235d245d255d265d275d285d295d2a5d2b5d2c5d2d5d2e2dde5d2f5d305d315d325d335d345d355d365d375d385d395d3a5d3b5d3c5d3d5d3e5d3f5d405d415d425d435d445d455d465d475d485d495d4a5d4b5d4c5d4d5d4e5d4f5d502b28'],
    '3_valve_2': [('server', ['MB', 0x02, 0x0003, 0x0404, 0x2020]), 'ff000000000000000000c000000000000001000000000000000000008000000000000000000000000d7d000000000000000000000e4e000000002000000000008000000000000000000000008000000000000000'],
    '2307': [('server', ['EB', 0x02, 0x0903, 0x0404, 0x2020]), ''],
    '4355': [('server', ['EB', 0x02, 0x1103, 0x0402, 0x2020]), ''],
    '9475': [('server', ['EB', 0x02, 0x2503, 0x0404, 0x2020]), ''],
}


